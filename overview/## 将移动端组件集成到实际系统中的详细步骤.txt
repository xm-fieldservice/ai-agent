## å°†ç§»åŠ¨ç«¯ç»„ä»¶é›†æˆåˆ°å®é™…ç³»ç»Ÿä¸­çš„è¯¦ç»†æ­¥éª¤

### 1. å»ºç«‹ä¸Overviewæ¨¡å—çš„è¿æ¥

éœ€è¦ä¿®æ”¹ `feature-service.ts` æ–‡ä»¶ï¼Œå°†æ¨¡æ‹Ÿä»£ç æ›¿æ¢ä¸ºå®é™…çš„Overview APIè°ƒç”¨ï¼š

```typescript
// ä»Overviewæ¨¡å—å¯¼å…¥API
import { 
  featuresApi, 
  FeatureType, 
  type Feature as OverviewFeature,
  FeatureEvents, 
  eventBus 
} from '../../overview/src';

// è½¬æ¢OverviewåŠŸèƒ½åˆ°ç§»åŠ¨ç«¯åŠŸèƒ½
private mapOverviewFeature(feature: OverviewFeature): Feature {
  return {
    id: feature.id,
    name: feature.name,
    type: feature.type,
    icon: feature.icon,
    description: feature.description,
    order: feature.order,
    disabled: feature.disabled
  };
}

// åˆå§‹åŒ–æ–¹æ³•ä¿®æ”¹
async initialize(): Promise<void> {
  if (this.isInitialized) return;
  
  try {
    // ä»Overviewæ¨¡å—è·å–åŠŸèƒ½
    const overviewFeatures = featuresApi.getVisibleFeatures();
    this.features = overviewFeatures.map(f => this.mapOverviewFeature(f));
    
    // ç›‘å¬åŠŸèƒ½å˜åŒ–
    featuresApi.onFeaturesChanged(features => {
      this.features = features.map(f => this.mapOverviewFeature(f));
      this.notifyListeners();
    });
    
    this.isInitialized = true;
    this.notifyListeners();
    console.info('åŠŸèƒ½æœåŠ¡åˆå§‹åŒ–å®Œæˆ');
  } catch (error) {
    console.error('åŠŸèƒ½æœåŠ¡åˆå§‹åŒ–å¤±è´¥:', error);
    throw error;
  }
}
```

### 2. å®ç°æ¶ˆæ¯ä¼ é€’æœºåˆ¶

åœ¨ `feature-service.ts` ä¸­æ·»åŠ äº‹ä»¶å¤„ç†å’Œæ¶ˆæ¯å‘é€åŠŸèƒ½ï¼š

```typescript
// å‘é€åŠŸèƒ½æ¶ˆæ¯
async sendFeatureMessage(featureId: string, message: string): Promise<any> {
  const feature = this.getFeatureById(featureId);
  if (!feature) {
    throw new Error(`åŠŸèƒ½[${featureId}]ä¸å­˜åœ¨`);
  }
  
  // é€šè¿‡Overviewçš„äº‹ä»¶æ€»çº¿å‘é€æ¶ˆæ¯
  eventBus.publish(`feature:${featureId}:message`, {
    id: Date.now().toString(),
    featureId,
    content: message,
    timestamp: new Date().toISOString(),
    source: 'mobile'
  });
  
  // è¿”å›Promiseä»¥æ”¯æŒå¼‚æ­¥å“åº”
  return new Promise((resolve) => {
    // ä¸€æ¬¡æ€§ç›‘å¬è¯¥åŠŸèƒ½çš„å“åº”
    const unsubscribe = eventBus.subscribe(`feature:${featureId}:response`, (response) => {
      unsubscribe();
      resolve(response);
    });
    
    // è®¾ç½®è¶…æ—¶å¤„ç†
    setTimeout(() => {
      unsubscribe();
      resolve({ error: 'è¯·æ±‚è¶…æ—¶' });
    }, 30000);
  });
}
```

### 3. æ³¨å†Œç§»åŠ¨ç«¯æ¨¡å—åˆ°Overview

åœ¨ `App.vue` çš„åˆå§‹åŒ–é€»è¾‘ä¸­æ·»åŠ ï¼š

```typescript
import { 
  systemApi, 
  FeatureType
} from '../../overview/src';

onMounted(async () => {
  try {
    // åˆå§‹åŒ–åŠŸèƒ½æœåŠ¡
    await featureService.initialize();
    
    // å‘Overviewæ³¨å†Œç§»åŠ¨ç«¯æ¨¡å—
    systemApi.registerModule('mobile', [
      {
        id: 'mobile-interface',
        name: 'ç§»åŠ¨ç«¯ç•Œé¢',
        type: FeatureType.SETTINGS,
        description: 'ç§»åŠ¨ç«¯ç‰¹æœ‰ç•Œé¢è®¾ç½®',
        icon: '/icons/mobile-icon.svg'
      }
    ]);
    
    console.info('ç§»åŠ¨ç«¯åº”ç”¨åˆå§‹åŒ–å®Œæˆ');
  } catch (error) {
    console.error('åº”ç”¨åˆå§‹åŒ–å¤±è´¥:', error);
  }
});
```

### 4. å¤„ç†ç•Œé¢çŠ¶æ€åŒæ­¥

åœ¨ `ChatView.vue` ä¸­æ·»åŠ äº‹ä»¶ç›‘å¬ï¼š

```typescript
import { eventBus, FeatureEvents } from '../../overview/src';

// ç”Ÿå‘½å‘¨æœŸé’©å­
onMounted(() => {
  // ç›‘å¬åŠŸèƒ½é€‰æ‹©äº‹ä»¶
  const unsubscribeFeatureSelected = eventBus.subscribe(
    FeatureEvents.FEATURE_SELECTED, 
    (feature) => {
      // æ‰¾åˆ°å¯¹åº”çš„æœ¬åœ°åŠŸèƒ½
      const localFeature = availableFeatures.value.find(f => f.id === feature.id);
      if (localFeature) {
        handleFeatureSelect(localFeature);
      }
    }
  );
  
  // ç›‘å¬æ¶ˆæ¯å“åº”
  const unsubscribeMessageResponse = eventBus.subscribe(
    'messages:received',
    (message) => {
      // å¤„ç†æ”¶åˆ°çš„æ¶ˆæ¯
      console.log('æ”¶åˆ°æ¶ˆæ¯:', message);
      // è¿™é‡Œæ·»åŠ æ¶ˆæ¯æ˜¾ç¤ºé€»è¾‘
    }
  );
  
  // ç»„ä»¶å¸è½½æ—¶å–æ¶ˆè®¢é˜…
  onUnmounted(() => {
    unsubscribeFeatureSelected();
    unsubscribeMessageResponse();
  });
});
```

### 5. é”™è¯¯å¤„ç†ä¸é‡è¯•æœºåˆ¶

åœ¨ `feature-service.ts` ä¸­æ·»åŠ é”™è¯¯å¤„ç†ï¼š

```typescript
// é”™è¯¯å¤„ç†ä¸é‡è¯•
private async withRetry<T>(
  operation: () => Promise<T>, 
  retries = 3, 
  delay = 1000
): Promise<T> {
  try {
    return await operation();
  } catch (error) {
    if (retries <= 0) throw error;
    
    console.warn(`æ“ä½œå¤±è´¥ï¼Œå°†åœ¨${delay}msåé‡è¯•ï¼Œå‰©ä½™é‡è¯•æ¬¡æ•°: ${retries}`);
    await new Promise(resolve => setTimeout(resolve, delay));
    
    return this.withRetry(operation, retries - 1, delay * 1.5);
  }
}

// åº”ç”¨åˆ°åˆå§‹åŒ–æ–¹æ³•
async initialize(): Promise<void> {
  if (this.isInitialized) return;
  
  try {
    await this.withRetry(async () => {
      // åˆå§‹åŒ–ä»£ç ...
    });
  } catch (error) {
    console.error('åŠŸèƒ½æœåŠ¡åˆå§‹åŒ–å¤±è´¥:', error);
    throw error;
  }
}
```

### 6. åŠ è½½çŠ¶æ€å¤„ç†

åœ¨ `ChatView.vue` ä¸­æ·»åŠ åŠ è½½çŠ¶æ€ï¼š

```typescript
// çŠ¶æ€
const loading = ref(false);
const error = ref<string | null>(null);

// åŠ è½½åŠŸèƒ½
async function loadFeatures() {
  loading.value = true;
  error.value = null;
  
  try {
    // åŠ è½½åŠŸèƒ½
    await featureService.initialize();
    availableFeatures.value = featureService.getVisibleFeatures();
    
    // é»˜è®¤é€‰æ‹©ç¬¬ä¸€ä¸ªåŠŸèƒ½
    if (availableFeatures.value.length > 0 && !selectedFeature.value) {
      handleFeatureSelect(availableFeatures.value[0]);
    }
  } catch (e) {
    error.value = 'åŠ è½½åŠŸèƒ½å¤±è´¥ï¼Œè¯·é‡è¯•';
    console.error(e);
  } finally {
    loading.value = false;
  }
}
```

## å½“å‰è¿›åº¦è¡¨

### å·²å®Œæˆä»»åŠ¡

| æ¨¡å— | ä»»åŠ¡ | çŠ¶æ€ |
|------|------|------|
| **Overview** | æ ¸å¿ƒAPIè®¾è®¡ | âœ… å®Œæˆ |
| **Overview** | äº‹ä»¶æ€»çº¿ | âœ… å®Œæˆ |
| **Overview** | åŠŸèƒ½æ³¨å†Œè¡¨ | âœ… å®Œæˆ |
| **Overview** | é»˜è®¤åŠŸèƒ½å®šä¹‰ | âœ… å®Œæˆ |
| **Overview** | ç³»ç»Ÿåˆå§‹åŒ– | âœ… å®Œæˆ |
| **Overview** | æ¨¡å—é›†æˆæ¥å£ | âœ… å®Œæˆ |
| **Mobile** | PWAåŸºç¡€é…ç½® | âœ… å®Œæˆ |
| **Mobile** | ç§»åŠ¨ç«¯é€‚é… | âœ… å®Œæˆ |
| **Mobile** | è°ƒè¯•å·¥å…· | âœ… å®Œæˆ |
| **Mobile** | åŠŸèƒ½é€‰æ‹©å™¨ | âœ… å®Œæˆ |
| **Mobile** | å¯æŠ˜å è¾“å…¥æ¡† | âœ… å®Œæˆ |
| **Mobile** | èŠå¤©è§†å›¾ | âœ… å®Œæˆ |
| **Mobile** | åŠŸèƒ½æœåŠ¡ | âœ… å®Œæˆ |

### è¿›è¡Œä¸­ä»»åŠ¡

| æ¨¡å— | ä»»åŠ¡ | çŠ¶æ€ |
|------|------|------|
| **Mobile** | ä¸Overviewé›†æˆ | ğŸ”„ è¿›è¡Œä¸­ |
| **Overview** | å®é™…æ¶ˆæ¯å¤„ç† | ğŸ”„ è¿›è¡Œä¸­ |

### å¾…å®Œæˆä»»åŠ¡

| æ¨¡å— | ä»»åŠ¡ | é¢„è®¡æ—¶é—´ |
|------|------|---------|
| **Mobile** | æ¶ˆæ¯å†å²ç»„ä»¶ | 2å¤© |
| **Mobile** | æ¶ˆæ¯å±•ç¤ºç»„ä»¶ | 3å¤© |
| **Mobile** | ç¦»çº¿åŠŸèƒ½æ”¯æŒ | 3å¤© |
| **Mobile** | å•å…ƒæµ‹è¯• | 2å¤© |
| **PC** | åŸºç¡€æ¶æ„è®¾è®¡ | 4å¤© |
| **PC** | æ¡Œé¢UIç»„ä»¶ | 7å¤© |
| **PC** | é«˜çº§ç¼–è¾‘åŠŸèƒ½ | 5å¤© |
| **LLM** | æ¨¡å‹æ¥å£å°è£… | 4å¤© |
| **LLM** | æç¤ºè¯å·¥ç¨‹ | 5å¤© |
| **LLM** | ä¸Šä¸‹æ–‡ç®¡ç† | 3å¤© |
| **æ•°æ®** | å­˜å‚¨æ¥å£è®¾è®¡ | 3å¤© |
| **æ•°æ®** | æ•°æ®åŒæ­¥æœºåˆ¶ | 4å¤© |
| **ç³»ç»Ÿ** | éƒ¨ç½²é…ç½® | 3å¤© |
| **ç³»ç»Ÿ** | é›†æˆæµ‹è¯• | 5å¤© |

### åç»­è®¡åˆ’

1. **ç¬¬ä¸€é˜¶æ®µ**ï¼šå®Œæˆç§»åŠ¨ç«¯ä¸Overviewçš„å®Œæ•´é›†æˆ
   - å®ç°æ¶ˆæ¯å†å²å’Œå±•ç¤º
   - å®Œæˆç¦»çº¿åŠŸèƒ½
   - å•å…ƒæµ‹è¯•è¦†ç›–

2. **ç¬¬äºŒé˜¶æ®µ**ï¼šPCæ¨¡å—å¼€å‘
   - å®ç°æ¡Œé¢ç«¯ç‰¹æœ‰UI
   - é«˜çº§ç¼–è¾‘åŠŸèƒ½å¼€å‘
   - ä¸Overviewé›†æˆ

3. **ç¬¬ä¸‰é˜¶æ®µ**ï¼šLLMå’Œæ•°æ®æ¨¡å—å¼€å‘
   - å®ç°æ¨¡å‹è°ƒç”¨æ¥å£
   - è®¾è®¡æ•°æ®å­˜å‚¨å’ŒåŒæ­¥æœºåˆ¶
   - é›†æˆåˆ°ç°æœ‰ç³»ç»Ÿ

4. **æœ€ç»ˆé˜¶æ®µ**ï¼šç³»ç»Ÿéƒ¨ç½²ä¸æµ‹è¯•
   - å®Œæ•´ç³»ç»Ÿæµ‹è¯•
   - éƒ¨ç½²é…ç½®
   - æ€§èƒ½ä¼˜åŒ–
